var ZKEACMS=ZKEACMS||{};ZKEACMS.Basket={Add:function(n,t){$.post("/Basket/Add",n,function(n){n.location?window.location=n.location:t&&t.call(n)})},Update:function(n,t){$.post("/Basket/Update",n,function(n){n.location?window.location=n.location:t&&t.call(n)})},Remove:function(n,t){$.post("/Basket/Remove",{basketId:n},function(n){n.location?window.location=n.location:t&&t.call(n)})},Get:function(n){$.post("/Basket/GetBaskets",{basketId:basketId},function(t){t.location?window.location=t.location:n&&n.call(t)})},ShowBasket:function(){$.post("/Basket/Index",function(n){if(n.location)window.location=n.location;else{var i=$("body>.basket"),t=$(n);i.length>0?(t.addClass("active"),i.replaceWith(t)):($("body").append(t),setTimeout(function(){t.addClass("active")},10))}},"html")}};$(function(){$(document).on("click",".basket .close",function(){$("body>.basket").removeClass("active");setTimeout(function(){$("body>.basket").remove()},300)});$(document).on("click",".add-to-basket",function(){var t=$(this).data("tags"),n;t||(n=[],$(this).closest(".product-ecommerce").find("input[type=radio]:checked").each(function(){n.push($(this).val())}),n.length>0&&(t=n.join(";")));ZKEACMS.Basket.Add({productId:$(this).data("productid"),quantity:$(this).data("quantity"),tags:t},function(){ZKEACMS.Basket.ShowBasket()})});$(document).on("click",".basket .quantity-minus",function(){var n=Number($.trim($(this).closest(".quantity-set").find(".quantity").text())),t,i;n>1&&(n-=1,t=$(this).closest(".row"),t.find(".quantity").text(n),i=t.data("id"),Easy.Processor(function(){ZKEACMS.Basket.Update({basketId:i,quantity:n},function(){$(".basket .total-items").text(this.data.quantity);$(".basket .total-price").text(this.data.total.toFixed(2))})},300))});$(document).on("click",".basket .quantity-plus",function(){var n=Number($.trim($(this).closest(".quantity-set").find(".quantity").text())),t,i;n+=1;t=$(this).closest(".row");t.find(".quantity").text(n);i=t.data("id");Easy.Processor(function(){ZKEACMS.Basket.Update({basketId:i,quantity:n},function(){$(".basket .total-items").text(this.data.quantity);$(".basket .total-price").text(this.data.total.toFixed(2))})},300)});$(document).on("click",".basket .remove",function(){var n=$(this).closest(".row").data("id");ZKEACMS.Basket.Remove(n,function(){$(".basket #basket-"+n).remove();$(".basket .basket-body>ul>li").length==0&&$(".basket .basket-body>ul").append('<li class="row empty text-center">您的购物车是空的<\/li >')})});$(document).on("click",".basket .ckeck-out",function(){$.post("/Basket/CheckOut",function(n){if(n.location)window.location=n.location;else{var i=$("body>.basket"),t=$(n);i.length>0?(t.addClass("active"),i.replaceWith(t)):($("body").append(t),setTimeout(function(){t.addClass("active")},10))}},"html")});$(document).on("click",".basket .confirm-order",function(){$(this).closest("form").submit()})});